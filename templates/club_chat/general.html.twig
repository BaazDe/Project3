{% extends 'club_chat/index.html.twig' %}

{% block greenBox %}
    <section class="green-box general-chat-section">
        <ul>
        <li><h1><img onclick="window.location.href='{{ path('club_chat') }}'" src="{{ asset('build/images/back-arrow-icon.svg') }}" alt="">Chat général</h1>
        </li>

            {{ dump(app.user) }}
            {#{% for message in messages %}

                {% if is_granted('ROLE_CLUBER') %}
                    {% if (message.profilClub == app.user.profilClubs.owner.profilClubs.snapshot[0]) %}
                        <li class="general-chat-message">
                <span class="sentBy">
                    {% if message.profilSolo %}
                        {{ message.profilSolo.firstname }}
                    {% else %}
                        {{ message.profilClub.nameClub }}
                    {% endif %}
                </span>
                            <p class="message">{{ message.contentMessage }}</p><span class="sentAt">[{{ message.dateMessage.format('d-m-Y') }}]</span>
                        </li>
                    {% endif %}


                {% elseif is_granted('ROLE_USER') %}
                    {% if message.profilClub == app.user.profilClubs.owner.profilSolo.profilClub %}
                        <li class="general-chat-message">
                <span class="sentBy">
                    {% if message.profilSolo %}
                        {{ message.profilSolo.firstname }}
                    {% else %}
                        {{ message.profilClub.nameClub }}
                    {% endif %}
                </span>
                            <p class="message">{{ message.contentMessage }}</p><span class="sentAt">[{{ message.dateMessage.format('d-m-Y') }}]</span>
                        </li>
                    {% endif %}
                {% endif %}
            {% endfor %}#}



        </ul>
        {{ form_start(form) }}
        {{ form_errors(form) }}

        {{ form_row(form.contentMessage) }}
        <div class="input-message-bar">
            <button><img src="{{ asset('build/images/send-message-icon.svg') }}" alt=""></button>
        </div>
        {{ form_end(form) }}
    </section>
{% endblock greenBox %}

{#message.profilClub == app.user.profilClubs.owner.profilClubs.snapshot[0] FOR CLUB VIEW#}
{#message.profilClub == app.user.profilClubs.owner.profilSolo.profilClub  FOR SOLO VIEW#}
